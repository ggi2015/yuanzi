# 代码整洁之道

## 

## 有意义的命名 
- 名副其实  
    变量：指明**计量对象**和**计量单位**的名称；  
    选择体现本意的名称，能让人更容易理解和修改代码；  
    问题不在于代码的简介度，而在于代码的模糊度：即上下文在代码中未被明确体现的程度。  

- 避免误导  

- 做有意义的区分  
    以数字系列命名（a1，a2，...，aN）是依义命名的对立面。纯属误导。
    Product类，ProductInfo类，ProductData类，名称虽然不同，意思却无区别。Info与Data就像a，an和the一样，是意义含混的废话。  
    废话都是冗余。Variable一词永远不要出现在变量名中；Table一词永远不要出现在表名中；  
    要区分名称，就要以读者能鉴别不同之处的方式来区分。  

- 使用读得出来的名字  

- 使用可搜索的名称  
    找MAX_CLASSES_PER_SYUDENT更容易，但找数字7就麻烦了。长名称胜于短名称，搜得到的名称胜于用于自造编码代写就的名称。  
    单字母名仅用于短方法中的本地变量。名称长短应与其作用域大小相应。若变量或常量可能在多出代码中使用，应赋予其便于搜索的名称。  

- 避免使用编码  
    匈牙利语标记法
    成员前缀：  
        应当使用某种可以高亮或用颜色标出成员的编辑环境。  
    接口和实现[TODO]  

## 避免思维映射  
    不应当让读者在脑中把你的名称翻译为他们熟知的名称。  
    如单字母变量名，在作用域小、无名称冲突时，循环计数器可以被命名为i、j、k。  
    明确是王道，编写别人能理解的代码。  

## 类名
    类名不应当是动词。  
    类名和对象名应该是名词或名词短语，避免使用Manager、Processor、Data或Info这样的类名。  

## 方法名  
    方法名应当是动词或动词短语。  
    属性访问器、修改器和断言应该根据其值命名，并加上get、set和is前缀。  
    重载构造器时，使用描述了参数的静态工厂方法名。可以考虑将相应的构造器设置为private，强制使用这种命名手段[TODO]  

## 每个概念对应一个词
    给每个概念对应选一个词，并一以贯之。如，使用fetch、retrieve和get这类词，选一个就行；controller、manager和driver这类词，混杂用，就容易令人迷惑。

## 别用双关语  

## 使用解决方案领域名称

## 使用源自所涉问题领域的名称  
    如果不能用程序要熟悉的术语来给手头工作命名，就采用所涉问题领域而来的名称。  

## 添加有意义的语境   
    需要有良好命名的类、函数或名称空间来放置名称，给读者提供语境。如果没这么作，给名称添加前缀就是最后一招。  
    假如，有变量firstName、lastName、street、houseNumber、city、state和zipcode等变量，和在一起之道构成地址，但是单独一个state变量，无法知道；可以添加前缀addrFirstName、addrLastName、addrState等以提供语境。更好的方案是创建Address的类，这样即使编译器也知道这些变量属于更大的概念。 

## 避免无意义的语境  


## 函数  

### 短小  
经过漫长的试错，经验告诉我，函数就该小。每行都不该有150个字符那么长，函数也不该有100行那么长，20行封顶最佳。
if、else、while语句等，其中的代码应该只有一行，大抵是个函数调用。  
函数的缩进层级不应多于一层或两层。  

### 只做一件事  
函数应该做一件事。做好这件事。只做这一件事。  

### 每个函数一个抽象层级  
要确保函数只做一件事，函数中的语句都要在同一抽象层级上。  
自顶向下读代码：向下规则  
    想要让每个函数后面都跟着位于下一抽象层级的的函数，这样一来，在查看函数列表时，就能循抽象层级往下阅读了。
    另一种说法：程序就像是一系列def起头的段落，每一段都描述当前抽象层级，并引用位于下一抽象层级的后续def起头段落。  

### SWITCH 语句  
确保每个switch都埋藏在较低的抽象层级，而且永不重复。利用多态来实现这一点。
[TODO]

### 使用描述性名称  
长而具有描述性的名称，比描述性的长注释好。使用某种命名约定，让函数名称中的多个单词容易阅读，然后用这些单词给函数取个能够说清其功能的名称。  
命名方式要保持一致，使用于模块名一脉相承的短语、名词和动词给函数命名。

### 函数参数  
最理想的参数数量是零，其次是一，再次是二，应尽量避免三。有足够理由才能用三个及以上参数（多参数函数）。   
- 一元函数的普遍形式
    向函数传入单个参数的两种理由：问关于该参数的问题；或者操作该参数，将其转化为其他东西，再输出。  
    另一种不普遍但有用的单参数函数形式，事件(event)，有输入参数，无输出参数。程序将函数看作一个事件 ，使用该参数修改系统状态。要小心使用这种形式，让读者清楚了解这是事件，谨慎选用名称和上下文语境。  
    尽量避免编写不遵循这些形式的一元函数。  
- 标识参数  
    传入标示参数，即意味着该函数不止做一件事。
- 二元函数  
    尽量利用一些机制将其转换为一元函数。  
    如，把writeFile方法写成outputStream的成员之一，从而：outputStream.wirteFile(name)；或则把outputStream写成当前类的成员变量，从而无需再传递它；或者分离出FieldWriter的新类，在其构造器中采用outputStream，并包含一个write方法。  
- 三元函数  
    写三元函数之前，一定要想清楚。  
- 对象参数  
    如果函数看来需要两个、三个或者三个以上参数，就说明其中一些参数应该封装为类了。  
- 参数列表  
    当想要向函数传入数量可变的参数。  
- 动词与关键字  
    给函数取好名字，以解释函数意图及参数顺序和意图。
    一元函数：函数和参数应当形成一种良好的**动词/名词对**形式，如writeField(name):告诉我们name是一个Field。  
    函数名称的关键字形式，把参数的名称编码成函数名，如assertEqual改成assertExpecteedEqualsActual(expected, actual)。  

### 无副作用  
    时序性耦合，就应该体现在函数名称中说明。
    输出参数：普遍而言，应避免使用输出参数，如果函数必须要改变某种参数状态，就修改所属对象的状态巴。

### 分隔指令与询问  
    函数要做什么事，要回答什么事情，但二者不可得兼。函数应该修改某对象的状态，或是返回该状态的有关信息。  

### 使用异常替代返回错误码  
    返回错误码，就是在要求调用者立刻处理错误。  
    但，如果用异常替代返回错误码，错误处理代码就能从主路径代码中分离出来，得到简化。  
  - 抽离Try/Catch代码  
    Try/Catch代码块丑陋不堪，搞乱了代码结构，把错误处理与正常流程混为一谈。最好把try和catch代码块的主体部分抽离出来，另外形成函数。  
  - 错误处理就是一件事  
    处理错误的代码不该做其他事，只该有Try/Catch代码块，后面不该有其他东西。  
  - 异常派生
    使用异常替代错误码，新异常可以从异常类中派生出来，无须重新编译或部署。  

### 别重复自己  

### 结构化编程  
    只要保持函数短小，偶尔出现return、break或continue语句没有坏处，甚至比单出原则更有表现力。goto只在大函数中才有道理，尽量避免使用。  

### 代码需要反复打磨，分解函数，修改名称、消除重复；缩短和重新安置方法，或拆散类，以保持测试通过。最后按照上述规则，组装函数。  
    每人能一开始就按照规则写函数。  

    